#summary Installing ScratchBox for Chumby One Development.

= Introduction =
* WORK IN PROGRESS *

Add your content here.
= Installing VirtualBox on amd64 =
{{{
nano /etc/apt/sources.list.d/virtualbox.list
deb http://download.virtualbox.org/virtualbox/debian squeeze contrib non-free
}}}
{{{
wget -q http://download.virtualbox.org/virtualbox/debian/oracle_vbox.asc -O- | sudo apt-key add -
sudo apt-get update
sudo apt-get install virtualbox-4.0
}}}

= Install Debian 6 - 32-bit to virtualbox =
download netinst iso (45.5MB) and install it. Clean install without scratchbox will take about 2G. Give 1024MB of ram and 100G of disk for the image. Disk is dynamic allocated.
{{{
wget http://cdimage.debian.org/debian-cd/6.0.1a/i386/iso-cd/debian-6.0.1a-i386-businesscard.iso
}}}
select correct keyboard option for your keyboard and use english as language. select default options except:
{{{
on tasksel:
[ ] Graphical desktop environment
[ ] Web server
[ ] Print server
[ ] DNS server
[ ] File server
[ ] Mail server
[ ] SQL database
[*] SSH server
[ ] Laptop
[*] Standard system utilities
}}}
TODO: add screenshots

make port forward from virtual machine to localhost port 2222

= Installing ScratchBox on virtual Debian 6 32-bit =
http://wiki.chumby.com/index.php/Scratchbox

{{{
su
}}}

{{{
nano /etc/apt/sources.list.d/scratchbox.list
deb http://scratchbox.org/debian stable main
}}}

{{{
apt-get update
apt-get install scratchbox-core scratchbox-libs
apt-get install scratchbox-toolchain-host-gcc scratchbox-devkit-doctools scratchbox-devkit-perl scratchbox-devkit-debian scratchbox-devkit-cputransp
}}}
note that cputransp is not available for amd64.

{{{
chgrp -R sbox /scratchbox/compilers
chmod -R g+w /scratchbox/compilers
mkdir /scratchbox/device_tools
chgrp -R sbox /scratchbox/device_tools
chmod -R g+w /scratchbox/device_tools
}}}

{{{
echo 4096 > /proc/sys/vm/mmap_min_addr
}}}

{{{
/scratchbox/sbin/sbox_adduser [user]
}}}

{{{
exit
}}}

{{{
/scratchbox/login
[sbox-NO-TARGET: ~] > sb-menu
}}}

create host target.. add screenshots here.

{{{
Shell restarting...
[sbox-HOST: ~] > 
}}}

{{{
cd /scratchbox/compilers
wget http://files.chumby.com/toolchain/arm-2008q3-72-arm-none-linux-gnueabi-i686-pc-linux-gnu.tar.bz2
tar -xvjpf arm-2008q3-72-arm-none-linux-gnueabi-i686-pc-linux-gnu.tar.bz
cd arm-2008q3
ln -s arm-none-linux-gnueabi/libc/usr/include .
ln -s /scratchbox/compilers/arm-2008q3/arm-none-linux-gnueabi/include/c++ include/c++
}}}

{{{
pushd ~
rm -rf sb-toolchain-extras
darcs get --set-scripts-executable http://scratchbox.org/repos/1.0/sb-toolchain-extras
popd
~/sb-toolchain-extras/confhelper/create_toolchain_conf.py > ~/sb-toolchain-extras/meta/alien-tc/arm-2008q3.conf
}}}

{{{
cd ~/sb-toolchain-extras
nano meta/alien-tc/arm-2008q3.conf
COMPILER_PACKAGE = chumby
}}}

{{{
make CONFIG=meta/alien-tc/arm-2008q3.conf -C meta/alien-tc all-sums
make CONFIG=meta/alien-tc/arm-2008q3.conf -C meta/alien-tc
}}}

{{{
nano /scratchbox/compilers/arm-2008q3/target_setup.sh
os.system('echo export SBOX_EXTRA_COMPILER_ARGS=-Wno-poison-system-directories >> ' + target + '.environment')
}}}